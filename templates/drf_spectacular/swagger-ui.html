<!DOCTYPE html>
<html>
  <head>
    <title>
      {% if title %}{{ title }}{% else %}API Documentation{% endif %}
    </title>
    <!-- Primary Meta Tags -->
    <meta
      name="title"
      content="{% if title %}{{ title }}{% else %}API Documentation{% endif %}"
    />
    <meta
      name="description"
      content="{% if description %}{{ description }}{% else %}API documentation{% endif %}"
    />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta
      property="og:title"
      content="{% if title %}{{ title }}{% else %}API Documentation{% endif %}"
    />
    <meta
      property="og:description"
      content="{% if description %}{{ description }}{% else %}API documentation{% endif %}"
    />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta
      property="twitter:title"
      content="{% if title %}{{ title }}{% else %}API Documentation{% endif %}"
    />
    <meta
      property="twitter:description"
      content="{% if description %}{{ description }}{% else %}API documentation{% endif %}"
    />

    <link
      rel="stylesheet"
      type="text/css"
      href="https://unpkg.com/swagger-ui-dist@4.15.5/swagger-ui.css"
    />
    <link
      rel="icon"
      type="image/png"
      href="https://unpkg.com/swagger-ui-dist@4.15.5/favicon-32x32.png"
      sizes="32x32"
    />
    <link
      rel="icon"
      type="image/png"
      href="https://unpkg.com/swagger-ui-dist@4.15.5/favicon-16x16.png"
      sizes="16x16"
    />
    <style>
      html {
        box-sizing: border-box;
        overflow: -moz-scrollbars-vertical;
        overflow-y: scroll;
      }

      *,
      *:before,
      *:after {
        box-sizing: inherit;
      }

      body {
        margin: 0;
        background: #fafafa;
      }

      /* Custom navbar styles */
      .api-nav {
        background: #1f2937;
        padding: 1rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin-bottom: 2rem;
      }

      .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .nav-title {
        color: #f9fafb;
        font-size: 1.5rem;
        font-weight: bold;
        text-decoration: none;
      }

      .nav-dropdown {
        position: relative;
        display: inline-block;
      }

      .dropdown-button {
        background: #3b82f6;
        color: white;
        padding: 0.5rem 1rem;
        font-size: 1rem;
        border: none;
        border-radius: 0.375rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: background-color 0.2s;
      }

      .dropdown-button:hover {
        background: #2563eb;
      }

      .dropdown-content {
        display: none;
        position: absolute;
        right: 0;
        background: white;
        min-width: 200px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        border-radius: 0.375rem;
        z-index: 1000;
        overflow: hidden;
      }

      .dropdown-content.show {
        display: block;
      }

      .dropdown-item {
        color: #374151;
        padding: 0.75rem 1rem;
        text-decoration: none;
        display: block;
        transition: background-color 0.2s;
      }

      .dropdown-item:hover {
        background: #f3f4f6;
      }

      .dropdown-item.active {
        background: #dbeafe;
        color: #1d4ed8;
        font-weight: 500;
      }

      .dropdown-separator {
        height: 1px;
        background: #e5e7eb;
        margin: 0.25rem 0;
      }

      /* Badge styles */
      .nav-badge {
        display: inline-flex;
        align-items: center;
        padding: 0.25rem 0.5rem;
        font-size: 0.75rem;
        font-weight: 500;
        border-radius: 9999px;
        margin-left: 0.5rem;
      }

      .badge-app {
        background: #dbeafe;
        color: #1e40af;
      }
      .badge-admin {
        background: #fee2e2;
        color: #991b1b;
      }
      .badge-external {
        background: #d1fae5;
        color: #065f46;
      }
      .badge-all {
        background: #e5e7eb;
        color: #374151;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .nav-container {
          flex-direction: column;
          text-align: center;
        }

        .nav-title {
          margin-bottom: 0.5rem;
        }
      }
    </style>
  </head>

  <body>
    <!-- Custom Navigation Bar -->
    <nav class="api-nav">
      <div class="nav-container">
        <a href="/swagger/" class="nav-title">üìö API Documentation</a>

        <div class="nav-dropdown">
          <button class="dropdown-button" onclick="toggleDropdown()">
            <span id="current-api"
              >{{ current_title|default:"Select API" }}</span
            >
            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
              <path d="M7 10l5 5 5-5z" />
            </svg>
          </button>
          <div class="dropdown-content" id="dropdown-menu">
            <a
              href="/swagger/"
              class="dropdown-item {% if 'schema' == schema_url %}active{% endif %}"
            >
              üîó All APIs
              <span class="nav-badge badge-all">Complete</span>
            </a>
            <div class="dropdown-separator"></div>
            <a
              href="/swagger/app/"
              class="dropdown-item {% if 'app-schema' == schema_url %}active{% endif %}"
            >
              üì± App APIs
              <span class="nav-badge badge-app">Core</span>
            </a>
            <a
              href="/swagger/admin/"
              class="dropdown-item {% if 'admin-schema' == schema_url %}active{% endif %}"
            >
              üõ†Ô∏è Admin APIs
              <span class="nav-badge badge-admin">Management</span>
            </a>
            <a
              href="/swagger/external/"
              class="dropdown-item {% if 'external-schema' == schema_url %}active{% endif %}"
            >
              üåê External APIs
              <span class="nav-badge badge-external">Integration</span>
            </a>
            <div class="dropdown-separator"></div>
            <a href="/api/schema/" class="dropdown-item" target="_blank">
              üìÑ OpenAPI Schema (JSON)
            </a>
          </div>
        </div>
      </div>
    </nav>

    <div id="swagger-ui"></div>

    <script
      src="https://unpkg.com/swagger-ui-dist@4.15.5/swagger-ui-bundle.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/swagger-ui-dist@4.15.5/swagger-ui-standalone-preset.js"
      crossorigin
    ></script>
    <script>
      window.onload = function () {
        // Begin Swagger UI call region
        const ui = SwaggerUIBundle({
          url: "{{ schema_url }}",
          dom_id: "#swagger-ui",
          deepLinking: true,
          presets: [SwaggerUIBundle.presets.apis, SwaggerUIStandalonePreset],
          plugins: [SwaggerUIBundle.plugins.DownloadUrl],
          layout: "StandaloneLayout",
          requestInterceptor: (request) => {
            request.headers["X-CSRFToken"] = "{{ csrf_token }}";
            return request;
          },
          // Custom configurations
          docExpansion: "list",
          defaultModelsExpandDepth: 1,
          defaultModelExpandDepth: 1,
          displayOperationId: false,
          displayRequestDuration: true,
          filter: true,
          showExtensions: true,
          showCommonExtensions: true,
          tryItOutEnabled: true,
        });
        // End Swagger UI call region

        window.ui = ui;
      };

      // Dropdown toggle function
      function toggleDropdown() {
        const dropdown = document.getElementById("dropdown-menu");
        dropdown.classList.toggle("show");
      }

      // Close dropdown when clicking outside
      window.onclick = function (event) {
        if (
          !event.target.matches(".dropdown-button") &&
          !event.target.closest(".dropdown-button")
        ) {
          const dropdown = document.getElementById("dropdown-menu");
          if (dropdown.classList.contains("show")) {
            dropdown.classList.remove("show");
          }
        }
      };
    </script>
  </body>
</html>
